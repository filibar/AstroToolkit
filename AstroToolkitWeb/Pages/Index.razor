@page "/"
@using AstroToolkitWeb.Pages.Components
@using AstroToolkitWeb.Models
@using AstroToolkitWeb.Services
@using Microsoft.AspNetCore.Components.Web

<PageTitle>Astro Toolkit</PageTitle>

<h1>Current Conditions</h1>

<div>
    <WeatherIcon IconCode="@weatherData.IconCode" />
    <p>Temperature: @weatherData.Temperature</p>
    <p>Condition: @(weatherData.WeatherCondition ?? "Unknown")</p> </div>


<h1>Forecast</h1>
@foreach (var forecast in forecasts)
{
    <div>
        <WeatherIcon IconCode="@forecast.IconCode" />
        <div class="forecast-time">@forecast.Date.ToString("HH:mm")</div>
        <div class="forecast-temp">@forecast.TemperatureÂ°C</div>
        <div class="forecast-condition">@forecast.Description</div>
    </div>
}


@code {
    // Placeholder data - Replace with actual data fetching
    private WeatherData weatherData = new WeatherData { IconCode = "partly-cloudy", Temperature = 25, WeatherCondition = "Partly Cloudy" };
    private List<Forecast> forecasts = new List<Forecast>()
    {
        new Forecast { IconCode = "cloudy", Date = DateTime.Now.AddHours(10), Temperature = 22, Description = "Cloudy"},
        new Forecast { IconCode = "clear", Date = DateTime.Now.AddHours(14), Temperature = 28, Description = "Clear"}
    };
}

@*  WeatherIcon Component (Assumption) *@
@inherits ComponentBase
<img src="@GetIconPath(IconCode)" alt="@IconCode" class="img-fluid mb-2" />

@code {
    [Parameter]
    public string? IconCode { get; set; }

    private string GetIconPath(string iconCode)
    {
        //Improved logic to handle different icon names
        string fileName = iconCode?.Replace("-", "_") ?? "default"; //Handle null IconCode
        return $"/images/moon/{fileName}.svg";
    }
}

// Data Models (Assumptions)
public class WeatherData
{
    public string? IconCode { get; set; } // Made IconCode nullable
    public int Temperature { get; set; }
    public string? WeatherCondition { get; set; } 
}

public class Forecast
{
    public string? IconCode { get; set; } //Made IconCode nullable
    public DateTime Date { get; set; }
    public int Temperature { get; set; }
    public string Description { get; set; }
}